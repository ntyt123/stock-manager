<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人股票信息系统</title>
    <link rel="stylesheet" href="/css/main.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- 顶部导航栏 -->
        <nav class="navbar">
            <div class="nav-brand">
                <h1>📈 个人股票信息系统</h1>
            </div>
            <div class="nav-menu" id="navMenu">
                <span class="user-info" id="userInfo">
                    <span id="userName">游客</span>
                    <span class="user-badge badge-user" id="userBadge">游客</span>
                </span>
                <button class="nav-btn" onclick="SettingsManager.openSettings()">⚙️ 设置</button>
                <button class="nav-btn" id="loginBtn" onclick="goToLogin()">登录</button>
                <button class="nav-btn" id="logoutBtn" onclick="logout()" style="display: none;">退出</button>
                <button class="nav-btn" id="adminBtn" onclick="goToAdmin()" style="display: none;">管理</button>
            </div>
        </nav>

        <!-- 系统状态栏 -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">系统状态:</span>
                <span class="status-value online">在线</span>
            </div>
            <div class="status-item">
                <span class="status-label">总资金:</span>
                <span class="status-value" id="totalCapitalDisplay">¥0.00</span>
                <button class="status-edit-btn" id="editCapitalBtn" onclick="openCapitalModal()" title="设置总资金">⚙️</button>
            </div>
            <div class="status-item">
                <span class="status-label">当前时间:</span>
                <span class="status-value" id="currentTime">--:--:--</span>
            </div>
            <div class="status-item">
                <span class="status-label">数据更新:</span>
                <span class="status-value" id="lastUpdate">--:--:--</span>
            </div>
        </div>

        <div class="header">
            <h1>个人股票信息系统</h1>
            <p>为您提供实时股票行情、投资组合管理和分析工具</p>
        </div>

        <!-- 页签导航 -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview">
                <span class="tab-icon">📊</span>
                <span class="tab-text">总览</span>
            </button>
            <button class="tab-btn" data-tab="market">
                <span class="tab-icon">🌍</span>
                <span class="tab-text">股市信息</span>
            </button>
            <button class="tab-btn" data-tab="analysis">
                <span class="tab-icon">📈</span>
                <span class="tab-text">分析</span>
            </button>
            <button class="tab-btn" data-tab="tools">
                <span class="tab-icon">🛠️</span>
                <span class="tab-text">工具</span>
            </button>
            <button class="tab-btn" data-tab="reports">
                <span class="tab-icon">📑</span>
                <span class="tab-text">报表</span>
            </button>
        </div>

        <!-- 总览页签内容 -->
        <div class="tab-content active" id="overview-tab">
            <div class="tab-content-layout">
                <!-- 左侧子页签导航 -->
                <div class="sub-tab-navigation">
                    <button class="sub-tab-btn active" data-subtab="overview-watchlist">
                        <span class="sub-tab-icon">📈</span>
                        <span class="sub-tab-text">自选股行情</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-positions">
                        <span class="sub-tab-icon">📊</span>
                        <span class="sub-tab-text">我的持仓</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-market">
                        <span class="sub-tab-icon">🌍</span>
                        <span class="sub-tab-text">市场动态</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-stats">
                        <span class="sub-tab-icon">📊</span>
                        <span class="sub-tab-text">持仓概览</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-distribution">
                        <span class="sub-tab-icon">📈</span>
                        <span class="sub-tab-text">涨跌分布</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-system">
                        <span class="sub-tab-icon">⚙️</span>
                        <span class="sub-tab-text">系统统计</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-trading-plans">
                        <span class="sub-tab-icon">📋</span>
                        <span class="sub-tab-text">交易计划</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-cost-management">
                        <span class="sub-tab-icon">💰</span>
                        <span class="sub-tab-text">持仓成本</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-profit-analysis">
                        <span class="sub-tab-icon">📊</span>
                        <span class="sub-tab-text">盈亏分析</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-fund-management">
                        <span class="sub-tab-icon">💵</span>
                        <span class="sub-tab-text">资金管理（待开发）</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="overview-trade-log">
                        <span class="sub-tab-icon">📝</span>
                        <span class="sub-tab-text">交易日志（待开发）</span>
                    </button>
                </div>

                <!-- 右侧内容区域 -->
                <div class="sub-tab-content-area">
                    <!-- 快捷操作卡片 - 始终显示 -->
                    <div class="quick-action-banner">
                        <div class="quick-action-card primary-action" onclick="openManualPositionModal()">
                            <div class="action-icon">✍️</div>
                            <div class="action-content">
                                <div class="action-title">手动录入持仓</div>
                                <div class="action-desc">快速添加您的股票持仓信息</div>
                            </div>
                            <div class="action-arrow">→</div>
                        </div>
                        <div class="quick-action-card secondary-action" onclick="openTradeRecordModal()">
                            <div class="action-icon">📝</div>
                            <div class="action-content">
                                <div class="action-title">记录交易操作</div>
                                <div class="action-desc">记录买入、卖出等交易记录</div>
                            </div>
                            <div class="action-arrow">→</div>
                        </div>
                        <div class="quick-action-card info-action" onclick="viewTradeHistory()">
                            <div class="action-icon">📊</div>
                            <div class="action-content">
                                <div class="action-title">交易历史</div>
                                <div class="action-desc">查看所有历史交易记录</div>
                            </div>
                            <div class="action-arrow">→</div>
                        </div>
                    </div>

                    <!-- 自选股行情 -->
                    <div class="sub-tab-content active" id="overview-watchlist">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📈</div>
                                <div class="card-title">自选股行情</div>
                            </div>
                            <div class="watchlist-quotes" id="overviewWatchlistQuotes">
                                <div class="loading-text">正在加载自选股行情...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 我的持仓 -->
                    <div class="sub-tab-content" id="overview-positions">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📊</div>
                                <div class="card-title">我的持仓</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="openExcelUploadModal()">导入Excel</button>
                                    <button class="refresh-btn" onclick="clearUploadedData()">清空数据</button>
                                </div>
                            </div>

                            <div class="portfolio-summary-grid">
                                <div class="summary-item">
                                    <div class="summary-label">总资金</div>
                                    <div class="summary-value" id="positionTotalCapital">¥0.00</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">持仓市值</div>
                                    <div class="summary-value" id="uploadedTotalValue">¥0.00</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">仓位占比</div>
                                    <div class="summary-value" id="positionRatio">0%</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">总盈亏</div>
                                    <div class="summary-value" id="uploadedProfitLoss">¥0.00 (0.00%)</div>
                                </div>
                            </div>
                            <div class="positions-container" id="uploadedPositions">
                                <div class="loading-text">请导入Excel文件查看持仓数据</div>
                            </div>
                        </div>
                    </div>

                    <!-- 市场动态 -->
                    <div class="sub-tab-content" id="overview-market">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🌍</div>
                                <div class="card-title">市场动态</div>
                            </div>
                            <div class="watchlist-quotes" id="marketIndices">
                                <div class="loading-text">正在加载市场指数...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 持仓概览统计 -->
                    <div class="sub-tab-content" id="overview-stats">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📊</div>
                                <div class="card-title">持仓概览统计</div>
                            </div>
                            <div class="portfolio-stats" id="portfolioStats">
                                <div class="loading-text">正在加载持仓统计...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 涨跌分布 -->
                    <div class="sub-tab-content" id="overview-distribution">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📈</div>
                                <div class="card-title">涨跌分布</div>
                            </div>
                            <div class="change-distribution" id="changeDistribution">
                                <div class="loading-text">正在加载涨跌分布...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 系统使用统计 -->
                    <div class="sub-tab-content" id="overview-system">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">⚙️</div>
                                <div class="card-title">系统使用统计</div>
                            </div>
                            <div class="system-stats" id="systemStats">
                                <div class="loading-text">正在加载系统统计...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 交易计划管理 -->
                    <div class="sub-tab-content" id="overview-trading-plans">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📋</div>
                                <div class="card-title">交易计划管理</div>
                                <div class="header-actions">
                                    <button class="refresh-btn btn-create-plan">
                                        <span>➕ 新建计划</span>
                                    </button>
                                </div>
                            </div>
                            <div class="trading-plans-container" id="tradingPlansContainer">
                                <div class="loading-text">正在加载交易计划...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 持仓成本管理 -->
                    <div class="sub-tab-content" id="overview-cost-management">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">💰</div>
                                <div class="card-title">持仓成本管理</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="openCostAdjustmentModal()">
                                        <span>📋 成本调整</span>
                                    </button>
                                    <button class="refresh-btn" onclick="openAddCostRecordModal()">
                                        <span>➕ 添加记录</span>
                                    </button>
                                </div>
                            </div>
                            <div id="costManagementContent">
                                <div class="loading-text">正在加载持仓成本数据...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 盈亏分析 -->
                    <div class="sub-tab-content" id="overview-profit-analysis">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📊</div>
                                <div class="card-title">盈亏分析</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="ProfitAnalysisManager.loadProfitAnalysis()">
                                        <span>🔄 刷新</span>
                                    </button>
                                </div>
                            </div>
                            <div id="profitAnalysisContent">
                                <div class="loading-text">正在加载盈亏分析数据...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 资金管理（待开发） -->
                    <div class="sub-tab-content" id="overview-fund-management">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">💵</div>
                                <div class="card-title">资金管理 <span class="dev-badge">待开发</span></div>
                            </div>
                            <div class="feature-placeholder">
                                <div class="placeholder-icon">🚧</div>
                                <div class="placeholder-title">功能开发中</div>
                                <div class="placeholder-desc">
                                    <p>该功能正在努力开发中，敬请期待！</p>
                                    <p class="feature-intro"><strong>功能简介：</strong></p>
                                    <ul class="feature-list">
                                        <li>✅ 账户总资产追踪（现金 + 持仓市值）</li>
                                        <li>✅ 资金流水记录（入金、出金、分红）</li>
                                        <li>✅ 可用资金实时计算</li>
                                        <li>✅ 资产配置比例分析</li>
                                        <li>✅ 仓位控制提醒</li>
                                        <li>✅ 资产变化趋势图</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 交易日志（待开发） -->
                    <div class="sub-tab-content" id="overview-trade-log">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📝</div>
                                <div class="card-title">交易日志 <span class="dev-badge">待开发</span></div>
                            </div>
                            <div class="feature-placeholder">
                                <div class="placeholder-icon">🚧</div>
                                <div class="placeholder-title">功能开发中</div>
                                <div class="placeholder-desc">
                                    <p>该功能正在努力开发中，敬请期待！</p>
                                    <p class="feature-intro"><strong>功能简介：</strong></p>
                                    <ul class="feature-list">
                                        <li>✅ 每日交易复盘记录</li>
                                        <li>✅ 交易决策理由记录</li>
                                        <li>✅ 交易心得笔记</li>
                                        <li>✅ 错误交易分析</li>
                                        <li>✅ 成功案例总结</li>
                                        <li>✅ 日志搜索和标签</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 股市信息页签 -->
        <div id="market-tab" class="tab-content">
            <div class="tab-content-layout">
                <!-- 左侧子页签导航 -->
                <div class="sub-tab-navigation">
                    <button class="sub-tab-btn active" data-subtab="market-trade-time">
                        <span class="sub-tab-icon">🔔</span>
                        <span class="sub-tab-text">交易时段</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-overview">
                        <span class="sub-tab-icon">🌍</span>
                        <span class="sub-tab-text">市场概览</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-gainers">
                        <span class="sub-tab-icon">🔥</span>
                        <span class="sub-tab-text">涨幅榜</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-losers">
                        <span class="sub-tab-icon">📉</span>
                        <span class="sub-tab-text">跌幅榜</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-watchlist-manage">
                        <span class="sub-tab-icon">⭐</span>
                        <span class="sub-tab-text">自选股管理</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-watchlist-quotes">
                        <span class="sub-tab-icon">📊</span>
                        <span class="sub-tab-text">自选股行情</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-news">
                        <span class="sub-tab-icon">📰</span>
                        <span class="sub-tab-text">热点新闻</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-industry">
                        <span class="sub-tab-icon">🏢</span>
                        <span class="sub-tab-text">行业分布</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-stock-pool">
                        <span class="sub-tab-icon">🎯</span>
                        <span class="sub-tab-text">股票池管理（待开发）</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-alert">
                        <span class="sub-tab-icon">🔔</span>
                        <span class="sub-tab-text">预警提醒（待开发）</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="market-sentiment">
                        <span class="sub-tab-icon">📈</span>
                        <span class="sub-tab-text">市场情绪（待开发）</span>
                    </button>
                </div>

                <!-- 右侧内容区域 -->
                <div class="sub-tab-content-area">
                    <!-- 交易时段 -->
                    <div class="sub-tab-content active" id="market-trade-time">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🔔</div>
                                <div class="card-title">交易时段</div>
                            </div>
                            <div class="trade-time-reminder" id="tradeTimeReminder">
                                <div class="loading-text">正在加载交易时段信息...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 市场概览 -->
                    <div class="sub-tab-content" id="market-overview">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🌍</div>
                                <div class="card-title">市场概览</div>
                            </div>
                            <div class="market-overview" id="marketOverview">
                                <div class="loading-text">正在加载市场概览...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 涨幅榜 -->
                    <div class="sub-tab-content" id="market-gainers">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🔥</div>
                                <div class="card-title">涨幅榜 TOP10</div>
                            </div>
                            <div class="top-gainers" id="topGainers">
                                <div class="loading-text">正在加载涨幅榜...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 跌幅榜 -->
                    <div class="sub-tab-content" id="market-losers">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📉</div>
                                <div class="card-title">跌幅榜 TOP10</div>
                            </div>
                            <div class="top-losers" id="topLosers">
                                <div class="loading-text">正在加载跌幅榜...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 自选股管理 -->
                    <div class="sub-tab-content" id="market-watchlist-manage">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">⭐</div>
                                <div class="card-title">自选股管理</div>
                            </div>
                            <div class="watchlist-section">
                                <div class="watchlist-input">
                                    <input type="text" id="stockCodeInput" placeholder="输入股票代码或名称" class="input-field">
                                    <button class="action-btn" onclick="addToWatchlist()">添加自选股</button>
                                </div>
                                <div class="watchlist-container" id="watchlistContainer">
                                    <div class="loading-text">暂无自选股，请添加股票代码</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 自选股行情 -->
                    <div class="sub-tab-content" id="market-watchlist-quotes">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📊</div>
                                <div class="card-title">自选股行情</div>
                            </div>
                            <div class="watchlist-quotes" id="watchlistQuotes">
                                <div class="loading-text">暂无自选股行情数据</div>
                            </div>
                        </div>
                    </div>

                    <!-- 热点新闻 -->
                    <div class="sub-tab-content" id="market-news">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📰</div>
                                <div class="card-title">热点新闻</div>
                            </div>
                            <div class="news-categories">
                                <button class="news-category-btn active" data-category="latest">最新热点</button>
                                <button class="news-category-btn" data-category="stock">股市行情</button>
                                <button class="news-category-btn" data-category="tech">科技前沿</button>
                                <button class="news-category-btn" data-category="policy">政策解读</button>
                                <button class="news-category-btn" data-category="international">国际财经</button>
                                <button class="news-category-btn" data-category="positions">📊 我的持仓公告</button>
                            </div>
                            <div class="news-container" id="newsContainer">
                                <div class="loading-text">正在加载热点新闻...</div>
                            </div>
                        </div>
                    </div>

                    <!-- 行业分布 -->
                    <div class="sub-tab-content" id="market-industry">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🏢</div>
                                <div class="card-title">行业分布</div>
                            </div>
                            <div class="industry-distribution" id="industryDistribution">
                                <div class="loading-text">暂无行业分布数据</div>
                            </div>
                        </div>
                    </div>

                    <!-- 股票池管理（待开发） -->
                    <div class="sub-tab-content" id="market-stock-pool">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🎯</div>
                                <div class="card-title">股票池管理 <span class="dev-badge">待开发</span></div>
                            </div>
                            <div class="feature-placeholder">
                                <div class="placeholder-icon">🚧</div>
                                <div class="placeholder-title">功能开发中</div>
                                <div class="placeholder-desc">
                                    <p>该功能正在努力开发中，敬请期待！</p>
                                    <p class="feature-intro"><strong>功能简介：</strong></p>
                                    <ul class="feature-list">
                                        <li>✅ 创建多个自定义股票池（核心池、观察池、黑名单等）</li>
                                        <li>✅ 标签分类（价值股、成长股、周期股等）</li>
                                        <li>✅ 批量导入导出</li>
                                        <li>✅ 股票池筛选条件保存</li>
                                        <li>✅ 股票池业绩对比</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 预警提醒（待开发） -->
                    <div class="sub-tab-content" id="market-alert">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🔔</div>
                                <div class="card-title">预警提醒 <span class="dev-badge">待开发</span></div>
                            </div>
                            <div class="feature-placeholder">
                                <div class="placeholder-icon">🚧</div>
                                <div class="placeholder-title">功能开发中</div>
                                <div class="placeholder-desc">
                                    <p>该功能正在努力开发中，敬请期待！</p>
                                    <p class="feature-intro"><strong>功能简介：</strong></p>
                                    <ul class="feature-list">
                                        <li>✅ 价格预警（涨跌幅、突破支撑/阻力位）</li>
                                        <li>✅ 成交量异动预警</li>
                                        <li>✅ 重要公告提醒（财报、分红、重组等）</li>
                                        <li>✅ 止盈止损自动提醒</li>
                                        <li>✅ 自选股异动推送</li>
                                        <li>✅ 多渠道通知（浏览器、邮件、webhook）</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 市场情绪分析（待开发） -->
                    <div class="sub-tab-content" id="market-sentiment">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📈</div>
                                <div class="card-title">市场情绪分析 <span class="dev-badge">待开发</span></div>
                            </div>
                            <div class="feature-placeholder">
                                <div class="placeholder-icon">🚧</div>
                                <div class="placeholder-title">功能开发中</div>
                                <div class="placeholder-desc">
                                    <p>该功能正在努力开发中，敬请期待！</p>
                                    <p class="feature-intro"><strong>功能简介：</strong></p>
                                    <ul class="feature-list">
                                        <li>✅ 市场恐慌指数（VIX等）</li>
                                        <li>✅ 资金流向分析（北上资金、融资融券）</li>
                                        <li>✅ 龙虎榜数据</li>
                                        <li>✅ 大单追踪</li>
                                        <li>✅ 行业资金流向</li>
                                        <li>✅ 市场热度指标</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 分析页签 -->
        <div id="analysis-tab" class="tab-content">
            <div class="tab-content-layout">
                <!-- 左侧子页签导航 -->
                <div class="sub-tab-navigation">
                    <button class="sub-tab-btn active" data-subtab="analysis-ai-assistant">
                        <span class="sub-tab-icon">🤖</span>
                        <span class="sub-tab-text">AI投资助手</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-recommendation">
                        <span class="sub-tab-icon">💎</span>
                        <span class="sub-tab-text">股票推荐</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-call-auction">
                        <span class="sub-tab-icon">🕘</span>
                        <span class="sub-tab-text">集合竞价</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-portfolio">
                        <span class="sub-tab-icon">📈</span>
                        <span class="sub-tab-text">持仓分析</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-risk">
                        <span class="sub-tab-icon">⚠️</span>
                        <span class="sub-tab-text">风险预警</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-portfolio-optimize">
                        <span class="sub-tab-icon">🎯</span>
                        <span class="sub-tab-text">组合优化（待开发）</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-risk-control">
                        <span class="sub-tab-icon">🛡️</span>
                        <span class="sub-tab-text">风险控制（待开发）</span>
                    </button>
                    <button class="sub-tab-btn" data-subtab="analysis-fundamentals">
                        <span class="sub-tab-icon">📊</span>
                        <span class="sub-tab-text">基本面数据（待开发）</span>
                    </button>
                </div>

                <!-- 右侧内容区域 -->
                <div class="sub-tab-content-area">
                    <!-- AI投资助手 -->
                    <div class="sub-tab-content active" id="analysis-ai-assistant">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🤖</div>
                                <div class="card-title">AI投资助手</div>
                            </div>
                            <div class="ai-assistant" id="aiAssistant">
                                <div class="ai-input-section">
                                    <textarea
                                        id="aiInputText"
                                        class="ai-textarea"
                                        placeholder="请输入您的问题，例如：分析一下当前持仓的风险情况..."
                                        rows="4"
                                    ></textarea>
                                    <div class="ai-actions">
                                        <button class="action-btn" onclick="sendToAI()">
                                            <span class="btn-icon">🚀</span>
                                            <span class="btn-text">发送询问</span>
                                        </button>
                                        <button class="action-btn secondary" onclick="clearAIChat()">
                                            <span class="btn-icon">🗑️</span>
                                            <span class="btn-text">清空对话</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="ai-response-section" id="aiResponseSection" style="display: none;">
                                    <div class="ai-response-header">
                                        <span class="response-icon">💡</span>
                                        <span class="response-title">AI分析结果</span>
                                        <span class="response-time" id="aiResponseTime"></span>
                                    </div>
                                    <div class="ai-response-content" id="aiResponseContent">
                                        <div class="loading-text">正在思考中...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 股票推荐 -->
                    <div class="sub-tab-content" id="analysis-recommendation">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">💎</div>
                                <div class="card-title">AI股票推荐</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="viewRecommendationHistory()" id="recommendationHistoryBtn">
                                        <span>📅 查看历史</span>
                                    </button>
                                    <button class="refresh-btn" onclick="generateRecommendation()" id="generateRecommendationBtn">
                                        <span>🔍 生成推荐</span>
                                    </button>
                                </div>
                            </div>
                            <div class="stock-recommendation" id="stockRecommendation">
                                <div class="analysis-hint">
                                    <div class="hint-icon">💡</div>
                                    <div class="hint-content">
                                        <p class="hint-title">AI智能股票推荐</p>
                                        <p class="hint-desc">点击"生成推荐"按钮，AI将基于当前市场数据推荐值得买入的股票</p>
                                        <p class="hint-features">✅ 推荐理由 | ✅ 买入价位 | ✅ 止盈止损 | ✅ 风险提示</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 集合竞价分析 -->
                    <div class="sub-tab-content" id="analysis-call-auction">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">🕘</div>
                                <div class="card-title">集合竞价分析</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="viewCallAuctionHistory()" id="callAuctionHistoryBtn">
                                        <span>📅 查看历史</span>
                                    </button>
                                    <button class="refresh-btn" onclick="analyzeCallAuction()" id="callAuctionAnalyzeBtn">
                                        <span>🔍 立即分析</span>
                                    </button>
                                </div>
                            </div>
                            <div class="call-auction-analysis" id="callAuctionAnalysis">
                                <div class="analysis-hint">
                                    <div class="hint-icon">💡</div>
                                    <div class="hint-content">
                                        <p class="hint-title">AI集合竞价分析</p>
                                        <p class="hint-desc">点击"立即分析"按钮，AI将分析今日的集合竞价情况</p>
                                        <p class="hint-schedule">📅 系统每天9:30自动分析集合竞价</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 持仓分析 -->
                    <div class="sub-tab-content" id="analysis-portfolio">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">📈</div>
                                <div class="card-title">持仓分析报告</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="viewReportHistory()" id="historyBtn">
                                        <span>📋 查看历史</span>
                                    </button>
                                    <button class="refresh-btn" onclick="analyzePortfolio()" id="analyzeBtn">
                                        <span>🔍 立即分析</span>
                                    </button>
                                </div>
                            </div>
                            <div class="portfolio-analysis" id="portfolioAnalysis">
                                <div class="analysis-hint">
                                    <div class="hint-icon">💡</div>
                                    <div class="hint-content">
                                        <p class="hint-title">AI智能持仓分析</p>
                                        <p class="hint-desc">点击"立即分析"按钮，AI将对您的持仓进行全面深度分析</p>
                                        <p class="hint-schedule">📅 系统每天下午5点自动分析持仓</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 风险预警 -->
                    <div class="sub-tab-content" id="analysis-risk">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">⚠️</div>
                                <div class="card-title">风险预警</div>
                                <div class="header-actions">
                                    <button class="refresh-btn" onclick="loadRiskWarnings()">
                                        <span>🔄 刷新</span>
                                    </button>
                                </div>
                            </div>
                            <div class="risk-assessment" id="riskAssessment">
                                <div class="loading-text">暂无风险预警数据，请先进行持仓分析</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Excel上传模态框 -->
        <div id="excelUploadModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>导入Excel持仓数据</h3>
                    <button class="close-btn" onclick="closeExcelUploadModal()">×</button>
                </div>

                <!-- Excel文件上传区域 -->
                <div id="excelUploadArea" class="upload-area">
                    <div class="upload-icon">📁</div>
                    <div class="upload-text">拖拽Excel文件到此处上传</div>
                    <div class="upload-hint">支持.xls和.xlsx格式的持仓数据文件</div>
                    <input type="file" id="excelFileInput" accept=".xls,.xlsx" style="display: none;">
                    <button class="action-btn" onclick="document.getElementById('excelFileInput').click()">选择文件</button>
                </div>

                <div class="upload-status" id="uploadStatus"></div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeExcelUploadModal()">取消</button>
                </div>
            </div>
        </div>

        <!-- 分析报告历史记录模态框 -->
        <div id="reportHistoryModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 90%; width: 1000px;">
                <div class="modal-header">
                    <h3>📋 历史分析报告</h3>
                    <button class="close-btn" onclick="closeReportHistoryModal()">×</button>
                </div>

                <div class="report-history-content" id="reportHistoryContent">
                    <div class="loading-text">正在加载历史报告...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeReportHistoryModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 报告详情模态框 -->
        <div id="reportDetailModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 95%; width: 1200px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>📊 持仓分析报告详情</h3>
                    <button class="close-btn" onclick="closeReportDetailModal()">×</button>
                </div>

                <div class="report-detail-content" id="reportDetailContent">
                    <div class="loading-text">正在加载报告详情...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeReportDetailModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 集合竞价历史记录模态框 -->
        <div id="callAuctionHistoryModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 90%; width: 1000px;">
                <div class="modal-header">
                    <h3>📅 历史集合竞价分析</h3>
                    <button class="close-btn" onclick="closeCallAuctionHistoryModal()">×</button>
                </div>

                <div class="call-auction-history-content" id="callAuctionHistoryContent">
                    <div class="loading-text">正在加载历史记录...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeCallAuctionHistoryModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 集合竞价详情模态框 -->
        <div id="callAuctionDetailModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 95%; width: 1200px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>🕘 集合竞价分析详情</h3>
                    <button class="close-btn" onclick="closeCallAuctionDetailModal()">×</button>
                </div>

                <div class="call-auction-detail-content" id="callAuctionDetailContent">
                    <div class="loading-text">正在加载详情...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeCallAuctionDetailModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 股票推荐历史记录模态框 -->
        <div id="recommendationHistoryModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 90%; width: 1000px;">
                <div class="modal-header">
                    <h3>📅 历史股票推荐</h3>
                    <button class="close-btn" onclick="closeRecommendationHistoryModal()">×</button>
                </div>

                <div class="recommendation-history-content" id="recommendationHistoryContent">
                    <div class="loading-text">正在加载历史推荐...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeRecommendationHistoryModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 股票推荐详情模态框 -->
        <div id="recommendationDetailModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 95%; width: 1200px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>💎 股票推荐详情</h3>
                    <button class="close-btn" onclick="closeRecommendationDetailModal()">×</button>
                </div>

                <div class="recommendation-detail-content" id="recommendationDetailContent">
                    <div class="loading-text">正在加载详情...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeRecommendationDetailModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 手动持仓录入模态框 -->
        <div id="manualPositionModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h3>✍️ 手动录入持仓</h3>
                    <button class="close-btn" onclick="closeManualPositionModal()">×</button>
                </div>

                <div class="form-container">
                    <form id="manualPositionForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="posStockCode">股票代码 *</label>
                                <input type="text" id="posStockCode" class="form-input" placeholder="例如: 600519" required>
                            </div>
                            <div class="form-group">
                                <label for="posStockName">股票名称 *</label>
                                <input type="text" id="posStockName" class="form-input" placeholder="例如: 贵州茅台" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="posQuantity">持仓数量 *</label>
                                <input type="number" id="posQuantity" class="form-input" placeholder="例如: 1000" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="posCostPrice">成本价 *</label>
                                <input type="number" id="posCostPrice" class="form-input" placeholder="例如: 18.50" step="0.01" min="0" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="posBuyDate">买入日期 *</label>
                                <input type="date" id="posBuyDate" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label for="posCurrentPrice">当前价</label>
                                <input type="number" id="posCurrentPrice" class="form-input" placeholder="留空将自动获取" step="0.01" min="0">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="posNotes">备注</label>
                            <textarea id="posNotes" class="form-textarea" placeholder="记录买入理由、目标价位等信息..." rows="3"></textarea>
                        </div>

                        <div class="form-status" id="positionFormStatus"></div>
                    </form>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeManualPositionModal()">取消</button>
                    <button class="action-btn" onclick="submitManualPosition()">
                        <span>💾 保存持仓</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 交易记录录入模态框 -->
        <div id="tradeRecordModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h3>📝 记录交易操作</h3>
                    <button class="close-btn" onclick="closeTradeRecordModal()">×</button>
                </div>

                <div class="form-container">
                    <form id="tradeRecordForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tradeType">交易类型 *</label>
                                <select id="tradeType" class="form-input" required>
                                    <option value="">请选择交易类型</option>
                                    <option value="buy">买入</option>
                                    <option value="sell">卖出</option>
                                    <option value="add">加仓</option>
                                    <option value="reduce">减仓</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="tradeDate">交易日期 *</label>
                                <input type="date" id="tradeDate" class="form-input" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="tradeStockCode">股票代码 *</label>
                                <input type="text" id="tradeStockCode" class="form-input" placeholder="例如: 600519" required>
                            </div>
                            <div class="form-group">
                                <label for="tradeStockName">股票名称 *</label>
                                <input type="text" id="tradeStockName" class="form-input" placeholder="例如: 贵州茅台" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="tradeQuantity">交易数量 *</label>
                                <input type="number" id="tradeQuantity" class="form-input" placeholder="例如: 500" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="tradePrice">交易价格 *</label>
                                <input type="number" id="tradePrice" class="form-input" placeholder="例如: 19.20" step="0.01" min="0" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="tradeFee">手续费</label>
                                <input type="number" id="tradeFee" class="form-input" placeholder="例如: 5.00" step="0.01" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label for="tradeAmount">交易金额</label>
                                <input type="number" id="tradeAmount" class="form-input" placeholder="自动计算" readonly>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="tradeNotes">交易备注</label>
                            <textarea id="tradeNotes" class="form-textarea" placeholder="记录交易理由、市场分析等信息..." rows="3"></textarea>
                        </div>

                        <div class="form-status" id="tradeFormStatus"></div>
                    </form>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeTradeRecordModal()">取消</button>
                    <button class="action-btn" onclick="submitTradeRecord()">
                        <span>💾 保存记录</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 交易历史模态框 -->
        <div id="tradeHistoryModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 95%; width: 1200px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3>📊 交易历史</h3>
                    <button class="close-btn" onclick="closeTradeHistoryModal()">×</button>
                </div>

                <div class="trade-history-container" id="tradeHistoryContent">
                    <div class="loading-text">正在加载交易历史...</div>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeTradeHistoryModal()">关闭</button>
                </div>
            </div>
        </div>

        <!-- 交易计划模态框 -->
        <div id="tradingPlanModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <h3 id="tradingPlanModalTitle">📝 新建交易计划</h3>
                    <button class="close-btn" onclick="TradingPlanManager.closePlanModal()">×</button>
                </div>

                <div class="form-container">
                    <!-- 总资金信息 -->
                    <div class="capital-info-banner" id="capitalInfoBanner" style="display: none;">
                        <div class="capital-info-content">
                            <div class="capital-info-item">
                                <span class="capital-label">💰 总资金:</span>
                                <span class="capital-value" id="modalTotalCapital">¥0.00</span>
                            </div>
                            <div class="capital-info-item">
                                <span class="capital-label">📊 预计金额:</span>
                                <span class="capital-value" id="modalEstimatedAmount">¥0.00</span>
                            </div>
                            <div class="capital-info-item">
                                <span class="capital-label">📈 预计仓位:</span>
                                <span class="capital-value" id="modalPositionRatio">0%</span>
                            </div>
                        </div>
                    </div>

                    <form id="tradingPlanForm">
                        <!-- 基本信息 -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="planType">计划类型 *</label>
                                <select id="planType" class="form-input" required>
                                    <option value="">请选择</option>
                                    <option value="buy">买入</option>
                                    <option value="sell">卖出</option>
                                    <option value="add">加仓</option>
                                    <option value="reduce">减仓</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="planDate">执行日期 *</label>
                                <input type="date" id="planDate" class="form-input" required>
                            </div>
                        </div>

                        <!-- 股票信息 -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="planStockCode">股票代码 *</label>
                                <input type="text" id="planStockCode" class="form-input" placeholder="例如: 600519" required>
                            </div>
                            <div class="form-group">
                                <label for="planStockName">股票名称 *</label>
                                <input type="text" id="planStockName" class="form-input" placeholder="例如: 贵州茅台" required>
                            </div>
                        </div>

                        <!-- 价格设定 -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="planTargetPrice">目标价格 *</label>
                                <input type="number" id="planTargetPrice" class="form-input" placeholder="例如: 1850.00" step="0.01" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="planCurrentPrice">当前价格</label>
                                <input type="number" id="planCurrentPrice" class="form-input" placeholder="自动获取" step="0.01" min="0" readonly>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="planStopProfitPrice">
                                    止盈价格
                                    <span class="price-percentage" id="stopProfitPercentage">+0%</span>
                                </label>
                                <input type="number" id="planStopProfitPrice" class="form-input" placeholder="例如: 1950.00" step="0.01" min="0">
                                <input type="range" id="stopProfitSlider" class="price-slider" min="-50" max="50" value="0" step="1">
                                <div class="slider-labels">
                                    <span>-50%</span>
                                    <span>0%</span>
                                    <span>+50%</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="planStopLossPrice">
                                    止损价格
                                    <span class="price-percentage" id="stopLossPercentage">-0%</span>
                                </label>
                                <input type="number" id="planStopLossPrice" class="form-input" placeholder="例如: 1800.00" step="0.01" min="0">
                                <input type="range" id="stopLossSlider" class="price-slider" min="-50" max="50" value="0" step="1">
                                <div class="slider-labels">
                                    <span>-50%</span>
                                    <span>0%</span>
                                    <span>+50%</span>
                                </div>
                            </div>
                        </div>

                        <!-- 数量信息 -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="planQuantity">
                                    计划数量（股）
                                    <span class="quantity-percentage" id="quantityPercentage">0%</span>
                                </label>
                                <input type="number" id="planQuantity" class="form-input" placeholder="例如: 100" min="0">
                                <input type="range" id="quantitySlider" class="price-slider" min="0" max="100" value="0" step="1">
                                <div class="slider-labels">
                                    <span>0%</span>
                                    <span>50%</span>
                                    <span>100%</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="planPriority">优先级</label>
                                <select id="planPriority" class="form-input">
                                    <option value="1">⭐ 1 - 普通</option>
                                    <option value="2">⭐⭐ 2 - 较低</option>
                                    <option value="3" selected>⭐⭐⭐ 3 - 一般</option>
                                    <option value="4">⭐⭐⭐⭐ 4 - 重要</option>
                                    <option value="5">⭐⭐⭐⭐⭐ 5 - 最高</option>
                                </select>
                            </div>
                        </div>

                        <!-- 计划理由 -->
                        <div class="form-group">
                            <label for="planReason">计划理由 *</label>
                            <textarea id="planReason" class="form-textarea" placeholder="例如: 突破重要支撑位，技术面向好，MACD金叉..." rows="3" required></textarea>
                        </div>

                        <!-- 备注说明 -->
                        <div class="form-group">
                            <label for="planNotes">备注说明</label>
                            <textarea id="planNotes" class="form-textarea" placeholder="例如: 分批买入，先买50%，观察后续走势..." rows="2"></textarea>
                        </div>

                        <div class="form-status" id="planFormStatus"></div>
                    </form>
                </div>

                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="TradingPlanManager.closePlanModal()">取消</button>
                    <button class="action-btn" onclick="TradingPlanManager.submitPlan()">
                        <span id="planSubmitBtnText">💾 创建计划</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 股票详情悬浮框 -->
        <div id="stockDetailTooltip" class="stock-tooltip" style="display: none;">
            <div class="stock-tooltip-header">
                <div class="stock-tooltip-title">
                    <span class="tooltip-stock-name" id="tooltipStockName">--</span>
                    <span class="tooltip-stock-code" id="tooltipStockCode">--</span>
                </div>
                <button class="tooltip-close-btn" onclick="closeStockTooltip()">×</button>
            </div>
            <div class="stock-tooltip-content">
                <div class="tooltip-loading" id="tooltipLoading">
                    <div class="loading-spinner-small"></div>
                    <span>正在加载股票详情...</span>
                </div>
                <div class="tooltip-data" id="tooltipData" style="display: none;">
                    <!-- 公司简介 -->
                    <div class="tooltip-section">
                        <div class="tooltip-section-title">公司简介</div>
                        <div class="tooltip-section-content" id="tooltipCompanyInfo">暂无数据</div>
                    </div>
                    <!-- 实时行情 -->
                    <div class="tooltip-section">
                        <div class="tooltip-section-title">实时行情</div>
                        <div class="tooltip-quote-grid">
                            <div class="tooltip-quote-item">
                                <span class="quote-label">当前价</span>
                                <span class="quote-value" id="tooltipCurrentPrice">--</span>
                            </div>
                            <div class="tooltip-quote-item">
                                <span class="quote-label">涨跌幅</span>
                                <span class="quote-value" id="tooltipChangePercent">--</span>
                            </div>
                            <div class="tooltip-quote-item">
                                <span class="quote-label">最高价</span>
                                <span class="quote-value" id="tooltipHigh">--</span>
                            </div>
                            <div class="tooltip-quote-item">
                                <span class="quote-label">最低价</span>
                                <span class="quote-value" id="tooltipLow">--</span>
                            </div>
                        </div>
                    </div>
                    <!-- K线图 -->
                    <div class="tooltip-section">
                        <div class="tooltip-section-header">
                            <div class="tooltip-section-title">K线图</div>
                            <div class="tooltip-period-selector">
                                <button class="tooltip-period-btn active" data-period="intraday">分时</button>
                                <button class="tooltip-period-btn" data-period="day">日线</button>
                                <button class="tooltip-period-btn" data-period="week">周线</button>
                                <button class="tooltip-period-btn" data-period="month">月线</button>
                            </div>
                        </div>
                        <div class="tooltip-chart-container">
                            <canvas id="tooltipChart" class="tooltip-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 总资金设置模态框 -->
        <div id="capitalModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <h2>💰 设置总资金</h2>
                    <button class="modal-close" onclick="closeCapitalModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="totalCapitalInput">总资金金额（元）</label>
                        <input type="number" id="totalCapitalInput" class="form-input" placeholder="请输入总资金金额" min="0" step="0.01">
                        <p class="form-hint">💡 总资金用于计算仓位比例和制定交易策略</p>
                    </div>
                    <div id="capitalFormStatus" class="form-status"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" onclick="closeCapitalModal()">取消</button>
                    <button class="btn btn-primary" onclick="saveTotalCapital()">保存</button>
                </div>
            </div>
        </div>

        <!-- 系统设置模态框 -->
        <div id="settingsModal" class="modal" style="display: none;">
            <div class="modal-content settings-modal-content">
                <div class="modal-header">
                    <h2>⚙️ 系统设置</h2>
                    <button class="modal-close" onclick="SettingsManager.closeSettings()">&times;</button>
                </div>

                <div class="settings-container">
                    <!-- 左侧导航栏 -->
                    <div class="settings-sidebar">
                        <div class="settings-nav-item active" data-section="account">
                            <span class="settings-nav-icon">👤</span>
                            <span class="settings-nav-text">账户设置</span>
                        </div>
                        <div class="settings-nav-item" data-section="capital">
                            <span class="settings-nav-icon">💰</span>
                            <span class="settings-nav-text">资金设置</span>
                        </div>
                        <div class="settings-nav-item" data-section="trading">
                            <span class="settings-nav-icon">📈</span>
                            <span class="settings-nav-text">交易设置</span>
                        </div>
                        <div class="settings-nav-item" data-section="display">
                            <span class="settings-nav-icon">🎨</span>
                            <span class="settings-nav-text">显示设置</span>
                        </div>
                        <div class="settings-nav-item" data-section="notification">
                            <span class="settings-nav-icon">🔔</span>
                            <span class="settings-nav-text">通知设置</span>
                        </div>
                        <div class="settings-nav-item" data-section="data">
                            <span class="settings-nav-icon">💾</span>
                            <span class="settings-nav-text">数据管理</span>
                        </div>
                        <div class="settings-nav-item" data-section="risk">
                            <span class="settings-nav-icon">⚠️</span>
                            <span class="settings-nav-text">风险管理</span>
                        </div>
                        <div class="settings-nav-item" data-section="system">
                            <span class="settings-nav-icon">ℹ️</span>
                            <span class="settings-nav-text">系统信息</span>
                        </div>
                    </div>

                    <!-- 右侧内容区域 -->
                    <div class="settings-content">
                        <!-- 账户设置 -->
                        <div class="settings-section active" id="settings-account">
                            <div class="settings-section-header">
                                <h3>👤 账户设置</h3>
                                <p class="settings-section-desc">管理您的账户信息</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">用户名</span>
                                        <span class="setting-desc">当前登录用户名</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="text" class="setting-input" id="setting-username" readonly>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">修改密码</span>
                                        <span class="setting-desc">更改您的登录密码</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.changePassword()">修改密码</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">用户角色</span>
                                        <span class="setting-desc">当前账户权限级别</span>
                                    </div>
                                    <div class="setting-control">
                                        <span class="setting-badge" id="setting-user-role">普通用户</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 资金设置 -->
                        <div class="settings-section" id="settings-capital">
                            <div class="settings-section-header">
                                <h3>💰 资金设置</h3>
                                <p class="settings-section-desc">配置您的资金管理参数</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">总资金</span>
                                        <span class="setting-desc">设置您的总投资资金</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-total-capital" placeholder="输入总资金金额" min="0" step="0.01">
                                        <span class="setting-unit">元</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">自动刷新间隔</span>
                                        <span class="setting-desc">持仓数据自动刷新的时间间隔</span>
                                    </div>
                                    <div class="setting-control">
                                        <select class="setting-select" id="setting-refresh-interval">
                                            <option value="0">不自动刷新</option>
                                            <option value="30">30秒</option>
                                            <option value="60">1分钟</option>
                                            <option value="300">5分钟</option>
                                            <option value="600">10分钟</option>
                                            <option value="1800">30分钟</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 交易设置 -->
                        <div class="settings-section" id="settings-trading">
                            <div class="settings-section-header">
                                <h3>📈 交易设置</h3>
                                <p class="settings-section-desc">配置交易相关参数</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">默认手续费率</span>
                                        <span class="setting-desc">交易时默认的手续费比例</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-fee-rate" placeholder="0.0003" min="0" max="1" step="0.0001">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">默认止盈比例</span>
                                        <span class="setting-desc">制定计划时的默认止盈百分比</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-stop-profit" placeholder="10" min="0" max="100" step="1">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">默认止损比例</span>
                                        <span class="setting-desc">制定计划时的默认止损百分比</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-stop-loss" placeholder="5" min="0" max="100" step="1">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">默认买入仓位</span>
                                        <span class="setting-desc">每次买入时默认使用的资金比例</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-default-position" placeholder="30" min="0" max="100" step="5">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 显示设置 -->
                        <div class="settings-section" id="settings-display">
                            <div class="settings-section-header">
                                <h3>🎨 显示设置</h3>
                                <p class="settings-section-desc">个性化您的界面显示</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">主题模式</span>
                                        <span class="setting-desc">选择界面的配色方案</span>
                                    </div>
                                    <div class="setting-control">
                                        <select class="setting-select" id="setting-theme">
                                            <option value="light">浅色模式</option>
                                            <option value="dark">深色模式</option>
                                            <option value="auto">跟随系统</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">自动刷新行情</span>
                                        <span class="setting-desc">是否自动刷新股票行情数据</span>
                                    </div>
                                    <div class="setting-control">
                                        <label class="setting-switch">
                                            <input type="checkbox" id="setting-auto-refresh">
                                            <span class="setting-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">K线图默认周期</span>
                                        <span class="setting-desc">查看股票详情时的默认K线周期</span>
                                    </div>
                                    <div class="setting-control">
                                        <select class="setting-select" id="setting-chart-period">
                                            <option value="intraday">分时</option>
                                            <option value="day">日线</option>
                                            <option value="week">周线</option>
                                            <option value="month">月线</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">涨跌颜色</span>
                                        <span class="setting-desc">选择涨跌的颜色显示方式</span>
                                    </div>
                                    <div class="setting-control">
                                        <select class="setting-select" id="setting-color-scheme">
                                            <option value="red-green">涨红跌绿</option>
                                            <option value="green-red">涨绿跌红</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 通知设置 -->
                        <div class="settings-section" id="settings-notification">
                            <div class="settings-section-header">
                                <h3>🔔 通知设置</h3>
                                <p class="settings-section-desc">管理系统提醒和通知</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">启用通知</span>
                                        <span class="setting-desc">是否启用系统通知功能</span>
                                    </div>
                                    <div class="setting-control">
                                        <label class="setting-switch">
                                            <input type="checkbox" id="setting-enable-notification">
                                            <span class="setting-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">价格预警</span>
                                        <span class="setting-desc">股价触及目标价时提醒</span>
                                    </div>
                                    <div class="setting-control">
                                        <label class="setting-switch">
                                            <input type="checkbox" id="setting-price-alert">
                                            <span class="setting-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">计划提醒</span>
                                        <span class="setting-desc">交易计划到期时提醒</span>
                                    </div>
                                    <div class="setting-control">
                                        <label class="setting-switch">
                                            <input type="checkbox" id="setting-plan-reminder">
                                            <span class="setting-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">风险提醒</span>
                                        <span class="setting-desc">出现风险信号时提醒</span>
                                    </div>
                                    <div class="setting-control">
                                        <label class="setting-switch">
                                            <input type="checkbox" id="setting-risk-alert">
                                            <span class="setting-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 数据管理 -->
                        <div class="settings-section" id="settings-data">
                            <div class="settings-section-header">
                                <h3>💾 数据管理</h3>
                                <p class="settings-section-desc">管理您的数据和缓存</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">导出数据</span>
                                        <span class="setting-desc">导出持仓、交易记录、计划等所有数据</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.exportData()">💾 导出数据</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">导入数据</span>
                                        <span class="setting-desc">从导出的文件中还原数据</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.importData()">📥 导入数据</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">数据备份</span>
                                        <span class="setting-desc">备份所有系统数据（同导出数据）</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.backupData()">📦 立即备份</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">还原备份</span>
                                        <span class="setting-desc">从备份文件还原数据（同导入数据）</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.restoreBackup()">📂 还原备份</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">清除缓存</span>
                                        <span class="setting-desc">清除本地行情缓存（不影响数据）</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn warning" onclick="SettingsManager.clearCache()">🗑️ 清除缓存</button>
                                    </div>
                                </div>
                                <div class="setting-item danger-zone">
                                    <div class="setting-label">
                                        <span class="setting-title danger-title">清除所有数据</span>
                                        <span class="setting-desc danger-desc">⚠️ 危险操作！将永久删除您的所有持仓、交易记录、计划等数据（保留账户）</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn danger" onclick="SettingsManager.clearAllData()">🔥 清除所有数据</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 风险管理 -->
                        <div class="settings-section" id="settings-risk">
                            <div class="settings-section-header">
                                <h3>⚠️ 风险管理</h3>
                                <p class="settings-section-desc">配置风险控制参数</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">风险偏好</span>
                                        <span class="setting-desc">您的投资风险承受能力</span>
                                    </div>
                                    <div class="setting-control">
                                        <select class="setting-select" id="setting-risk-preference">
                                            <option value="conservative">保守型</option>
                                            <option value="balanced">平衡型</option>
                                            <option value="aggressive">激进型</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">单日最大亏损预警</span>
                                        <span class="setting-desc">单日亏损超过此比例时预警</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-daily-loss-limit" placeholder="5" min="0" max="100" step="1">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">最大持仓比例</span>
                                        <span class="setting-desc">总仓位不超过总资金的此比例</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-max-position" placeholder="80" min="0" max="100" step="5">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">单股最大仓位</span>
                                        <span class="setting-desc">单只股票不超过总资金的此比例</span>
                                    </div>
                                    <div class="setting-control">
                                        <input type="number" class="setting-input" id="setting-single-stock-limit" placeholder="20" min="0" max="100" step="5">
                                        <span class="setting-unit">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 系统信息 -->
                        <div class="settings-section" id="settings-system">
                            <div class="settings-section-header">
                                <h3>ℹ️ 系统信息</h3>
                                <p class="settings-section-desc">查看系统版本和统计信息</p>
                            </div>
                            <div class="settings-section-body">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">系统版本</span>
                                        <span class="setting-desc">当前系统版本号</span>
                                    </div>
                                    <div class="setting-control">
                                        <span class="setting-value">v0.1.0</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">持仓股票数</span>
                                        <span class="setting-desc">当前持有的股票数量</span>
                                    </div>
                                    <div class="setting-control">
                                        <span class="setting-value" id="setting-stock-count">--</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">交易记录数</span>
                                        <span class="setting-desc">历史交易记录总数</span>
                                    </div>
                                    <div class="setting-control">
                                        <span class="setting-value" id="setting-trade-count">--</span>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">使用帮助</span>
                                        <span class="setting-desc">查看系统使用文档</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.showHelp()">查看帮助</button>
                                    </div>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <span class="setting-title">关于</span>
                                        <span class="setting-desc">关于本系统</span>
                                    </div>
                                    <div class="setting-control">
                                        <button class="setting-btn" onclick="SettingsManager.showAbout()">关于</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer settings-footer">
                    <button class="btn btn-outline" onclick="SettingsManager.resetSettings()">恢复默认</button>
                    <div class="footer-actions">
                        <button class="btn btn-outline" onclick="SettingsManager.closeSettings()">关闭</button>
                        <button class="btn btn-primary" onclick="SettingsManager.saveSettings()">保存设置</button>
                    </div>
                </div>
            </div>
        </div>
        
         <!-- 成本详情模态框 -->
        <div id="costDetailModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 95%; width: 1200px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3 id="costDetailTitle">持仓成本详情</h3>
                    <button class="close-btn" onclick="closeCostDetailModal()">×</button>
                </div>
                <div id="costDetailContent">
                    <div class="loading-text">正在加载成本详情...</div>
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeCostDetailModal()">关闭</button>






                </div>
            </div>
        </div>

        <!-- 添加成本记录模态框 -->
        <div id="addCostRecordModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h3>➕ 添加成本记录</h3>
                    <button class="close-btn" onclick="closeAddCostRecordModal()">×</button>
                </div>
                <div class="form-container">
                    <form id="addCostRecordForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="costRecordStockCode">股票代码 *</label>
                                <input type="text" id="costRecordStockCode" class="form-input" placeholder="例如: 600519" required>
                            </div>
                            <div class="form-group">
                                <label for="costRecordStockName">股票名称 *</label>
                                <input type="text" id="costRecordStockName" class="form-input" placeholder="例如: 贵州茅台" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="costRecordOperationType">操作类型 *</label>
                                <select id="costRecordOperationType" class="form-input" required>
                                    <option value="">请选择</option>
                                    <option value="buy">买入</option>
                                    <option value="sell">卖出</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="costRecordOperationDate">交易日期 *</label>
                                <input type="date" id="costRecordOperationDate" class="form-input" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="costRecordQuantity">数量（股）*</label>
                                <input type="number" id="costRecordQuantity" class="form-input" placeholder="例如: 1000" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="costRecordPrice">价格 *</label>
                                <input type="number" id="costRecordPrice" class="form-input" placeholder="例如: 18.50" step="0.01" min="0" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="costRecordAmount">交易金额</label>
                            <input type="number" id="costRecordAmount" class="form-input" placeholder="自动计算" readonly>
                        </div>
                        <div class="form-group">
                            <label for="costRecordNotes">备注</label>
                            <textarea id="costRecordNotes" class="form-textarea" placeholder="记录交易理由、市场分析等信息..." rows="2"></textarea>
                        </div>
                        <div class="form-status" id="costRecordFormStatus"></div>
                    </form>
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeAddCostRecordModal()">取消</button>
                    <button class="action-btn" onclick="submitCostRecord()">
                        <span>💾 保存记录</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- 成本调整模态框 -->
        <div id="costAdjustmentModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h3>📋 成本调整</h3>
                    <button class="close-btn" onclick="closeCostAdjustmentModal()">×</button>
                </div>
                <div class="form-container">
                    <form id="costAdjustmentForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="adjustmentStockCode">股票代码 *</label>
                                <input type="text" id="adjustmentStockCode" class="form-input" placeholder="例如: 600519" required>
                            </div>
                            <div class="form-group">
                                <label for="adjustmentStockName">股票名称 *</label>
                                <input type="text" id="adjustmentStockName" class="form-input" placeholder="例如: 贵州茅台" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="adjustmentType">调整类型 *</label>
                                <select id="adjustmentType" class="form-input" required>
                                    <option value="">请选择</option>
                                    <option value="dividend">分红</option>
                                    <option value="bonus">送股</option>
                                    <option value="rights">配股</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="adjustmentDate">调整日期 *</label>
                                <input type="date" id="adjustmentDate" class="form-input" required>
                            </div>
                        </div>
                        <div class="form-group" id="dividendField">
                            <label for="dividendAmount">每股分红金额（元）*</label>
                            <input type="number" id="dividendAmount" class="form-input" placeholder="例如: 0.50" step="0.01" min="0">
                        </div>
                        <div class="form-group" id="bonusField">
                            <label for="bonusShares">每10股送股数 *</label>
                            <input type="number" id="bonusShares" class="form-input" placeholder="例如: 5（表示10送5）" step="1" min="0">
                        </div>
                        <div id="rightsFields">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="rightsShares">每10股配股数 *</label>
                                    <input type="number" id="rightsShares" class="form-input" placeholder="例如: 3（表示10配3）" step="1" min="0">
                                </div>
                                <div class="form-group">
                                    <label for="rightsPrice">配股价格（元）*</label>
                                    <input type="number" id="rightsPrice" class="form-input" placeholder="例如: 15.00" step="0.01" min="0">
                                </div>
                            </div>
                        </div>
                        <div class="form-status" id="adjustmentFormStatus"></div>
                    </form>
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeCostAdjustmentModal()">取消</button>
                    <button class="action-btn" onclick="submitCostAdjustment()">
                        <span>💾 保存调整</span>
                    </button>
                 </div>
            </div>
        </div>

        <div class="footer">
            <p>© 2024 个人股票信息系统 | 版本 0.1</p>
            <p>系统状态: 正常运行 | 最后更新: <span id="update-time"></span></p>
        </div>
    </div>

    <!-- 股票图表模块 -->
    <script src="/js/stockChart.js"></script>

    <!--  ==================== 功能模块 ====================  -->
    <!-- UI工具模块 -->
    <script src="/js/modules/ui-utils.js"></script>
    <!-- 总资金管理模块（需要最先加载，其他模块依赖它） -->
    <script src="/js/modules/capital-manager.js"></script>
    <!-- 设置管理模块 -->
    <script src="/js/modules/settings-manager.js"></script>
    <!-- 持仓管理模块 -->
    <script src="/js/modules/position-manager.js"></script>
    <!-- 自选股管理模块 -->
    <script src="/js/modules/watchlist-manager.js"></script>
    <!-- 分析功能模块 -->
    <script src="/js/modules/analysis-manager.js"></script>
    <!-- 市场数据模块 -->
    <script src="/js/modules/market-data.js"></script>
    <!-- 股票详情模块 -->
    <script src="/js/modules/stock-detail.js"></script>
    <!-- 推荐管理模块 -->
    <script src="/js/modules/recommendation-manager.js"></script>
    <!-- 交易管理模块 -->
    <script src="/js/modules/trade-manager.js"></script>
    <!-- 交易计划管理模块 -->
    <script src="/js/modules/trading-plan-manager.js"></script>
    <!-- 成本管理模块 -->
    <script src="/js/modules/cost-management.js"></script>
    <!-- 盈亏分析模块 -->
    <script src="/js/modules/profit-analysis-manager.js"></script>

    <!-- 核心初始化模块 -->
    <script src="/js/main-core.js"></script>
</body>
</html>