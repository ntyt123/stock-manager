<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªäººè‚¡ç¥¨ä¿¡æ¯ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: auto;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
            padding: 60px 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 4rem;
            font-weight: 300;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.4rem;
            color: #666;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(168, 237, 234, 0.3);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
            color: white;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .stock-list {
            list-style: none;
        }

        .stock-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(168, 237, 234, 0.2);
        }

        .stock-item:last-child {
            border-bottom: none;
        }

        .stock-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .stock-price {
            font-weight: 600;
            color: #27ae60;
        }

        .stock-change {
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }

        .positive {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
        }

        .negative {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .portfolio-value {
            font-size: 2.5rem;
            font-weight: 300;
            color: #2c3e50;
            text-align: center;
            margin: 20px 0;
        }

        .portfolio-change {
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 30px;
        }

        .chart-container {
            height: 200px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* å…‰å¤§è¯åˆ¸æŒä»“æ ·å¼ */
        .refresh-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: linear-gradient(135deg, #45a049 0%, #4CAF50 100%);
            transform: translateY(-1px);
        }

        .positions-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .position-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(168, 237, 234, 0.2);
        }

        .position-item:last-child {
            border-bottom: none;
        }

        .position-info {
            flex: 1;
        }

        .position-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1rem;
        }

        .position-code {
            font-size: 0.8rem;
            color: #7f8c8d;
            margin-top: 2px;
        }

        .position-details {
            text-align: right;
        }

        .position-price {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1rem;
        }

        .position-quantity {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 2px;
        }

        .position-profit {
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 4px;
        }

        .profit-positive {
            color: #27ae60;
        }

        .profit-negative {
            color: #e74c3c;
        }

        .loading-text {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px;
        }

        /* å…‰å¤§è¯åˆ¸ç™»å½•è¡¨å•æ ·å¼ */
        .login-form {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid #e9ecef;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.25);
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .login-status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
        }

        .login-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .login-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .login-status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* Excelä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-area {
            border: 2px dashed #a8edea;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            background: rgba(168, 237, 234, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: rgba(168, 237, 234, 0.2);
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #667eea;
        }

        .upload-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .upload-hint {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 20px;
        }

        .upload-status {
            margin: 15px 0;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
            display: none;
        }

        .upload-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .upload-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .upload-status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* ç¾åŒ–æŒä»“æ˜¾ç¤ºæ ·å¼ */
        .position-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(168, 237, 234, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .position-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1), 0 3px 6px rgba(0, 0, 0, 0.05);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .position-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .position-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .stock-info {
            flex: 1;
        }

        .stock-symbol {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }

        .stock-name {
            font-size: 0.95rem;
            color: #7f8c8d;
            font-weight: 500;
        }

        .profit-indicator {
            font-size: 1.8rem;
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
        }

        .profit-indicator.profit {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
        }

        .profit-indicator.loss {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .position-stats {
            background: rgba(168, 237, 234, 0.08);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .stat-row:last-child {
            margin-bottom: 0;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex: 1;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #7f8c8d;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .position-summary {
            display: flex;
            justify-content: flex-end;
            margin-top: 10px;
        }

        .profit-loss {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .profit-loss.profit {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }

        .profit-loss.loss {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3);
        }

        .profit-amount {
            font-size: 1.2rem;
        }

        .profit-rate {
            font-size: 1rem;
            opacity: 0.9;
        }

        .positions-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .positions-list {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .position-card {
                padding: 15px;
                margin: 10px 0;
            }
            
            .stat-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat-item {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 0;
            border-radius: 8px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.2em;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-btn:hover {
            color: #333;
            background-color: #f5f5f5;
            border-radius: 50%;
        }
        
        .modal-actions {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .action-btn.secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .action-btn.secondary:hover {
            background-color: #5a6268;
        }

        .info-message {
            text-align: center;
            color: #6c757d;
            padding: 40px 20px;
            font-style: italic;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: #27ae60;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .status-text {
            font-size: 1.1rem;
            color: #666;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ æ ·å¼ */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .nav-brand h1 {
            font-size: 1.8rem;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: rgba(168, 237, 234, 0.2);
            border-radius: 25px;
            font-weight: 600;
            color: #2c3e50;
        }

        .user-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-super-admin {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            color: white;
        }

        .badge-admin {
            background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%);
            color: white;
        }

        .badge-user {
            background: linear-gradient(135deg, #A8EDEA 0%, #FED6E3 100%);
            color: #2C3E50;
        }

        .nav-btn {
            padding: 8px 20px;
            border: 2px solid #a8edea;
            background: transparent;
            color: #2c3e50;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #8A2BE2;
            color: white;
            transform: translateY(-2px);
        }

        /* ç³»ç»ŸçŠ¶æ€æ æ ·å¼ */
        .status-bar {
            display: flex;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-label {
            font-weight: 600;
            color: #666;
        }

        .status-value {
            font-weight: 600;
            color: #8A2BE2;
        }

        .status-value.online {
            color: #27ae60;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px 0;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid rgba(138, 43, 226, 0.3);
        }

        /* æŒä»“æ•°æ®æ›´æ–°ä¿¡æ¯æ ·å¼ */
        .position-update-info {
            background: rgba(138, 43, 226, 0.1);
            border: 1px solid rgba(138, 43, 226, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        .update-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .update-label {
            font-weight: 600;
            color: #8A2BE2;
        }

        .update-time {
            color: #666;
        }



        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .header p {
                font-size: 1.1rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <nav class="navbar">
            <div class="nav-brand">
                <h1>ğŸ“ˆ ä¸ªäººè‚¡ç¥¨ä¿¡æ¯ç³»ç»Ÿ</h1>
            </div>
            <div class="nav-menu" id="navMenu">
                <span class="user-info" id="userInfo">
                    <span id="userName">æ¸¸å®¢</span>
                    <span class="user-badge badge-user" id="userBadge">æ¸¸å®¢</span>
                </span>
                <button class="nav-btn" id="loginBtn" onclick="goToLogin()">ç™»å½•</button>
                <button class="nav-btn" id="logoutBtn" onclick="logout()" style="display: none;">é€€å‡º</button>
                <button class="nav-btn" id="adminBtn" onclick="goToAdmin()" style="display: none;">ç®¡ç†</button>
            </div>
        </nav>

        <!-- ç³»ç»ŸçŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">ç³»ç»ŸçŠ¶æ€:</span>
                <span class="status-value online">åœ¨çº¿</span>
            </div>
            <div class="status-item">
                <span class="status-label">å½“å‰æ—¶é—´:</span>
                <span class="status-value" id="currentTime">--:--:--</span>
            </div>
            <div class="status-item">
                <span class="status-label">æ•°æ®æ›´æ–°:</span>
                <span class="status-value" id="lastUpdate">--:--:--</span>
            </div>
        </div>

        <div class="header">
            <h1>ä¸ªäººè‚¡ç¥¨ä¿¡æ¯ç³»ç»Ÿ</h1>
            <p>ä¸ºæ‚¨æä¾›å®æ—¶è‚¡ç¥¨è¡Œæƒ…ã€æŠ•èµ„ç»„åˆç®¡ç†å’Œåˆ†æå·¥å…·</p>
        </div>

        <div class="dashboard">
            <!-- å®æ—¶è¡Œæƒ…å¡ç‰‡ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸ“ˆ</div>
                    <div class="card-title">å®æ—¶è¡Œæƒ…</div>
                </div>
                <ul class="stock-list">
                    <li class="stock-item">
                        <span class="stock-name">è…¾è®¯æ§è‚¡</span>
                        <span class="stock-price">Â¥320.50</span>
                        <span class="stock-change positive">+2.3%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">é˜¿é‡Œå·´å·´</span>
                        <span class="stock-price">Â¥85.20</span>
                        <span class="stock-change positive">+1.8%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">è´µå·èŒ…å°</span>
                        <span class="stock-price">Â¥1,680.00</span>
                        <span class="stock-change negative">-0.5%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">å®å¾·æ—¶ä»£</span>
                        <span class="stock-price">Â¥210.75</span>
                        <span class="stock-change positive">+3.2%</span>
                    </li>
                </ul>
            </div>

            <!-- æˆ‘çš„æŒä»“å¡ç‰‡ -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ“Š</div>
                <div class="card-title">æˆ‘çš„æŒä»“</div>
                <div class="header-actions">
                    <button class="refresh-btn" onclick="openExcelUploadModal()">å¯¼å…¥Excel</button>
                    <button class="refresh-btn" onclick="clearUploadedData()">æ¸…ç©ºæ•°æ®</button>
                </div>
            </div>
            
            <div class="portfolio-value" id="uploadedTotalValue">Â¥0.00</div>
            <div class="portfolio-change" id="uploadedProfitLoss">æ€»ç›ˆäº: Â¥0.00 (0.00%)</div>
            <div class="positions-container" id="uploadedPositions">
                <div class="loading-text">è¯·å¯¼å…¥Excelæ–‡ä»¶æŸ¥çœ‹æŒä»“æ•°æ®</div>
            </div>
        </div>
        
        <!-- Excelä¸Šä¼ æ¨¡æ€æ¡† -->
        <div id="excelUploadModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>å¯¼å…¥ExcelæŒä»“æ•°æ®</h3>
                    <button class="close-btn" onclick="closeExcelUploadModal()">Ã—</button>
                </div>
                
                <!-- Excelæ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
                <div id="excelUploadArea" class="upload-area">
                    <div class="upload-icon">ğŸ“</div>
                    <div class="upload-text">æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </div>
                    <div class="upload-hint">æ”¯æŒ.xlså’Œ.xlsxæ ¼å¼çš„æŒä»“æ•°æ®æ–‡ä»¶</div>
                    <input type="file" id="excelFileInput" accept=".xls,.xlsx" style="display: none;">
                    <button class="action-btn" onclick="document.getElementById('excelFileInput').click()">é€‰æ‹©æ–‡ä»¶</button>
                </div>
                
                <div class="upload-status" id="uploadStatus"></div>
                
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="closeExcelUploadModal()">å–æ¶ˆ</button>
                </div>
            </div>
        </div>

            <!-- å¸‚åœºåŠ¨æ€å¡ç‰‡ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">ğŸŒ</div>
                    <div class="card-title">å¸‚åœºåŠ¨æ€</div>
                </div>
                <ul class="stock-list">
                    <li class="stock-item">
                        <span class="stock-name">ä¸Šè¯æŒ‡æ•°</span>
                        <span class="stock-price">3,250.68</span>
                        <span class="stock-change positive">+0.8%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">æ·±è¯æˆæŒ‡</span>
                        <span class="stock-price">11,280.45</span>
                        <span class="stock-change positive">+1.2%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">åˆ›ä¸šæ¿æŒ‡</span>
                        <span class="stock-price">2,280.15</span>
                        <span class="stock-change positive">+2.1%</span>
                    </li>
                    <li class="stock-item">
                        <span class="stock-name">æ’ç”ŸæŒ‡æ•°</span>
                        <span class="stock-price">16,850.30</span>
                        <span class="stock-change negative">-0.3%</span>
                    </li>
                </ul>
            </div>

            <!-- å¿«é€Ÿæ“ä½œå¡ç‰‡ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">âš¡</div>
                    <div class="card-title">å¿«é€Ÿæ“ä½œ</div>
                </div>
                <div class="quick-actions">
                    <button class="action-btn">ä¹°å…¥è‚¡ç¥¨</button>
                    <button class="action-btn">å–å‡ºè‚¡ç¥¨</button>
                    <button class="action-btn">æŸ¥çœ‹è¯¦æƒ…</button>
                    <button class="action-btn">è®¾ç½®æé†’</button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Â© 2024 ä¸ªäººè‚¡ç¥¨ä¿¡æ¯ç³»ç»Ÿ | ç‰ˆæœ¬ 0.1</p>
            <p>ç³»ç»ŸçŠ¶æ€: æ­£å¸¸è¿è¡Œ | æœ€åæ›´æ–°: <span id="update-time"></span></p>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        document.addEventListener('DOMContentLoaded', async function() {
            await checkAuth();
            updateTime();
            setInterval(updateTime, 1000);
            
            // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æ›´æ–°
            updateStockData();
            setInterval(updateStockData, 5000);
            
            // åˆå§‹åŒ–Excelä¸Šä¼ åŠŸèƒ½
            initExcelUpload();
            
            // é¡µé¢åŠ è½½å®Œæˆåï¼Œå»¶è¿ŸåŠ è½½ç”¨æˆ·æŒä»“æ•°æ®
            setTimeout(() => {
                loadUserPositions();
            }, 500);
        });
        
        // æ‰“å¼€Excelä¸Šä¼ æ¨¡æ€æ¡†
        function openExcelUploadModal() {
            const modal = document.getElementById('excelUploadModal');
            modal.style.display = 'block';
            
            // æ¸…ç©ºä¸Šä¼ çŠ¶æ€
            clearUploadStatus();
            
            // é‡æ–°ç»‘å®šæ‹–æ‹½äº‹ä»¶ï¼ˆç¡®ä¿æ¨¡æ€æ¡†æ˜¾ç¤ºåäº‹ä»¶ç»‘å®šæ­£ç¡®ï¼‰
            initExcelUpload();
        }
        
        // å…³é—­Excelä¸Šä¼ æ¨¡æ€æ¡†
        function closeExcelUploadModal() {
            const modal = document.getElementById('excelUploadModal');
            modal.style.display = 'none';
            
            // æ¸…ç©ºä¸Šä¼ çŠ¶æ€
            clearUploadStatus();
        }
        
        // æ¸…ç©ºä¸Šä¼ çŠ¶æ€
        function clearUploadStatus() {
            const uploadStatus = document.getElementById('uploadStatus');
            uploadStatus.textContent = '';
            uploadStatus.className = 'upload-status';
            
            // æ¸…ç©ºæ–‡ä»¶è¾“å…¥
            const fileInput = document.getElementById('excelFileInput');
            fileInput.value = '';
        }

        // åˆå§‹åŒ–Excelä¸Šä¼ åŠŸèƒ½
        function initExcelUpload() {
            const uploadArea = document.getElementById('excelUploadArea');
            const fileInput = document.getElementById('excelFileInput');
            
            if (!uploadArea || !fileInput) return;
            
            // æ‹–æ‹½äº‹ä»¶å¤„ç†
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleExcelFile(files[0]);
                }
            });
            
            // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
            fileInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    handleExcelFile(e.target.files[0]);
                }
            });
        }

        // å¤„ç†Excelæ–‡ä»¶ä¸Šä¼ 
        async function handleExcelFile(file) {
            if (!file) return;
            
            // æ£€æŸ¥æ–‡ä»¶ç±»å‹
            const validTypes = ['.xls', '.xlsx'];
            const fileExtension = file.name.toLowerCase().slice(file.name.lastIndexOf('.'));
            
            if (!validTypes.includes(fileExtension)) {
                showUploadStatus('è¯·ä¸Šä¼ .xlsæˆ–.xlsxæ ¼å¼çš„Excelæ–‡ä»¶', 'error');
                return;
            }
            
            const token = localStorage.getItem('token');
            if (!token) {
                showUploadStatus('è¯·å…ˆç™»å½•ç³»ç»Ÿ', 'error');
                return;
            }
            
            try {
                showUploadStatus('æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...', 'info');
                
                const formData = new FormData();
                formData.append('file', file);
                
                const response = await fetch('/api/upload/positions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showUploadStatus('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼æ­£åœ¨è§£ææŒä»“æ•°æ®...', 'success');
                    
                    // å»¶è¿Ÿåæ˜¾ç¤ºæŒä»“æ•°æ®
                    setTimeout(() => {
                        displayUploadedPositions(data.data.positions, data.data.summary);
                        showUploadStatus('æ•°æ®è§£æå®Œæˆï¼', 'success');
                        
                        // ä¸Šä¼ æˆåŠŸåå…³é—­æ¨¡æ€æ¡†
                        setTimeout(() => {
                            closeExcelUploadModal();
                        }, 500);
                    }, 1000);
                    
                } else {
                    showUploadStatus(data.error || 'æ–‡ä»¶ä¸Šä¼ å¤±è´¥', 'error');
                }
                
            } catch (error) {
                console.error('Excelæ–‡ä»¶ä¸Šä¼ é”™è¯¯:', error);
                showUploadStatus('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•', 'error');
            }
        }

        // æ˜¾ç¤ºä¸Šä¼ çŠ¶æ€
        function showUploadStatus(message, type) {
            const statusDiv = document.getElementById('uploadStatus');
            if (!statusDiv) return;
            
            statusDiv.textContent = message;
            statusDiv.className = `upload-status ${type}`;
            statusDiv.style.display = 'block';
        }

        // æ¸…ç©ºä¸Šä¼ çš„æ•°æ®
        async function clearUploadedData() {
            const token = localStorage.getItem('token');
            
            if (!token) {
                // æœªç™»å½•çŠ¶æ€ï¼Œåªæ¸…ç©ºæœ¬åœ°æ˜¾ç¤º
                document.getElementById('uploadedTotalValue').textContent = 'Â¥0.00';
                document.getElementById('uploadedProfitLoss').textContent = 'æ€»ç›ˆäº: Â¥0.00 (0.00%)';
                document.getElementById('uploadedPositions').innerHTML = 
                    '<div class="loading-text">è¯·ä¸Šä¼ Excelæ–‡ä»¶æŸ¥çœ‹æŒä»“æ•°æ®</div>';
                
                const statusDiv = document.getElementById('uploadStatus');
                if (statusDiv) {
                    statusDiv.style.display = 'none';
                    statusDiv.textContent = '';
                }
                
                const fileInput = document.getElementById('excelFileInput');
                if (fileInput) fileInput.value = '';
                
                // ç§»é™¤æ›´æ–°æ—¶é—´ä¿¡æ¯
                const updateInfo = document.getElementById('positionUpdateInfo');
                if (updateInfo) {
                    updateInfo.remove();
                }
                
                return;
            }
            
            // ç¡®è®¤æ¸…ç©ºæ“ä½œ
            if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æŒä»“æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                return;
            }
            
            try {
                const response = await fetch('/api/positions', {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        // æ¸…ç©ºæœ¬åœ°æ˜¾ç¤º
                        document.getElementById('uploadedTotalValue').textContent = 'Â¥0.00';
                        document.getElementById('uploadedProfitLoss').textContent = 'æ€»ç›ˆäº: Â¥0.00 (0.00%)';
                        document.getElementById('uploadedPositions').innerHTML = 
                            '<div class="loading-text">è¯·ä¸Šä¼ Excelæ–‡ä»¶æŸ¥çœ‹æŒä»“æ•°æ®</div>';
                        
                        const statusDiv = document.getElementById('uploadStatus');
                        if (statusDiv) {
                            statusDiv.style.display = 'none';
                            statusDiv.textContent = '';
                        }
                        
                        const fileInput = document.getElementById('excelFileInput');
                        if (fileInput) fileInput.value = '';
                        
                        // ç§»é™¤æ›´æ–°æ—¶é—´ä¿¡æ¯
                        const updateInfo = document.getElementById('positionUpdateInfo');
                        if (updateInfo) {
                            updateInfo.remove();
                        }
                        
                        showNotification('æŒä»“æ•°æ®å·²æ¸…ç©º', 'success');
                        console.log(`âœ… æŒä»“æ•°æ®å·²æ¸…ç©ºï¼Œåˆ é™¤äº† ${result.deletedCount} æ¡è®°å½•`);
                    } else {
                        showNotification('æ¸…ç©ºæ•°æ®å¤±è´¥ï¼š' + (result.error || 'æœªçŸ¥é”™è¯¯'), 'error');
                    }
                } else {
                    showNotification('æ¸…ç©ºæ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            } catch (error) {
                console.error('æ¸…ç©ºæŒä»“æ•°æ®é”™è¯¯:', error);
                showNotification('æ¸…ç©ºæ•°æ®å¤±è´¥ï¼Œç½‘ç»œè¿æ¥é”™è¯¯', 'error');
            }
        }

        // æ£€æŸ¥è®¤è¯çŠ¶æ€
        async function checkAuth() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            
            if (token && user) {
                try {
                    const response = await fetch('/api/auth/me', {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        const userData = await response.json();
                        updateNavbar(userData);
                        return;
                    }
                } catch (error) {
                    console.error('è®¤è¯æ£€æŸ¥å¤±è´¥:', error);
                }
            }
            
            // æœªç™»å½•çŠ¶æ€
            updateNavbar(null);
        }

        // æ˜¾ç¤ºä¸Šä¼ çš„æŒä»“æ•°æ®
        function displayUploadedPositions(positions, summary = null) {
            const container = document.getElementById('uploadedPositions');
            const totalValueEl = document.getElementById('uploadedTotalValue');
            const profitLossEl = document.getElementById('uploadedProfitLoss');
            
            if (!container || !totalValueEl || !profitLossEl) return;
            
            if (!positions || positions.length === 0) {
                container.innerHTML = '<div class="loading-text">æœªæ‰¾åˆ°æŒä»“æ•°æ®</div>';
                totalValueEl.textContent = 'Â¥0.00';
                profitLossEl.textContent = 'æ€»ç›ˆäº: Â¥0.00 (0.00%)';
                
                // ç§»é™¤æ›´æ–°æ—¶é—´ä¿¡æ¯
                const updateInfo = document.getElementById('positionUpdateInfo');
                if (updateInfo) {
                    updateInfo.remove();
                }
                
                return;
            }
            
            // å¦‚æœæä¾›äº†æ±‡æ€»ä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™é‡æ–°è®¡ç®—
            let totalMarketValue, totalProfitLoss, totalCost, profitLossRate;
            if (summary) {
                totalMarketValue = summary.totalMarketValue;
                totalProfitLoss = summary.totalProfitLoss;
                totalCost = summary.totalCost || 0;
                profitLossRate = summary.totalProfitLossRate;
                
                // æ˜¾ç¤ºæ›´æ–°æ—¶é—´ä¿¡æ¯
                if (summary.lastUpdate) {
                    const updateTime = new Date(summary.lastUpdate).toLocaleString('zh-CN');
                    
                    // åˆ›å»ºæˆ–æ›´æ–°çŠ¶æ€æ˜¾ç¤ºå…ƒç´ 
                    let statusDiv = document.getElementById('positionUpdateInfo');
                    if (!statusDiv) {
                        statusDiv = document.createElement('div');
                        statusDiv.id = 'positionUpdateInfo';
                        statusDiv.className = 'position-update-info';
                        const positionsContainer = document.getElementById('uploadedPositions');
                        if (positionsContainer) {
                            positionsContainer.parentNode.insertBefore(statusDiv, positionsContainer);
                        }
                    }
                    
                    statusDiv.innerHTML = `
                        <div class="update-info">
                            <span class="update-label">æ•°æ®æ›´æ–°æ—¶é—´:</span>
                            <span class="update-time">${updateTime}</span>
                        </div>
                    `;
                }
            } else {
                // è®¡ç®—æ€»å¸‚å€¼å’Œæ€»ç›ˆäº
                totalMarketValue = 0;
                totalProfitLoss = 0;
                totalCost = 0;
                
                positions.forEach(position => {
                    totalMarketValue += parseFloat(position.marketValue) || 0;
                    totalProfitLoss += parseFloat(position.profitLoss) || 0;
                    totalCost += parseFloat(position.costPrice) || 0;
                });
                
                profitLossRate = totalCost > 0 ? (totalProfitLoss / totalCost * 100).toFixed(2) : '0.00';
                
                // ç§»é™¤æ›´æ–°æ—¶é—´ä¿¡æ¯
                const updateInfo = document.getElementById('positionUpdateInfo');
                if (updateInfo) {
                    updateInfo.remove();
                }
            }
            
            // æ›´æ–°æ€»å¸‚å€¼å’Œç›ˆäºæ˜¾ç¤º
            totalValueEl.textContent = `Â¥${totalMarketValue.toFixed(2)}`;
            profitLossEl.textContent = `æ€»ç›ˆäº: Â¥${totalProfitLoss.toFixed(2)} (${profitLossRate}%)`;
            
            // ç”ŸæˆæŒä»“åˆ—è¡¨HTML
            let html = '<div class="positions-list">';
            
            positions.forEach(position => {
                const profitLoss = parseFloat(position.profitLoss) || 0;
                const profitLossRate = parseFloat(position.profitLossRate) || 0;
                const isProfit = profitLoss >= 0;
                const profitIcon = isProfit ? 'ğŸ“ˆ' : 'ğŸ“‰';
                
                html += `
                    <div class="position-card">
                        <div class="position-header">
                            <div class="stock-info">
                                <div class="stock-symbol">${position.stockCode}</div>
                                <div class="stock-name">${position.stockName}</div>
                            </div>
                            <div class="profit-indicator ${isProfit ? 'profit' : 'loss'}">
                                ${profitIcon}
                            </div>
                        </div>
                        
                        <div class="position-stats">
                            <div class="stat-row">
                                <div class="stat-item">
                                    <span class="stat-label">æŒä»“æ•°é‡</span>
                                    <span class="stat-value">${position.quantity}è‚¡</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">æˆæœ¬ä»·</span>
                                    <span class="stat-value">Â¥${parseFloat(position.costPrice).toFixed(2)}</span>
                                </div>
                            </div>
                            
                            <div class="stat-row">
                                <div class="stat-item">
                                    <span class="stat-label">å½“å‰ä»·</span>
                                    <span class="stat-value">Â¥${parseFloat(position.currentPrice).toFixed(2)}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">å¸‚å€¼</span>
                                    <span class="stat-value">Â¥${parseFloat(position.marketValue).toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="position-summary">
                            <div class="profit-loss ${isProfit ? 'profit' : 'loss'}">
                                <span class="profit-amount">${isProfit ? '+' : ''}Â¥${profitLoss.toFixed(2)}</span>
                                <span class="profit-rate">${isProfit ? '+' : ''}${profitLossRate.toFixed(2)}%</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // åŠ è½½ç”¨æˆ·æŒä»“æ•°æ®
        async function loadUserPositions() {
            const token = localStorage.getItem('token');
            if (!token) {
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œè·³è¿‡åŠ è½½æŒä»“æ•°æ®');
                return;
            }
            
            try {
                const response = await fetch('/api/positions', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data.positions.length > 0) {
                        // æ˜¾ç¤ºæŒä»“æ•°æ®
                        displayUploadedPositions(result.data.positions, result.data.summary);
                        
                        // æ˜¾ç¤ºæ›´æ–°æ—¶é—´ä¿¡æ¯
                        if (result.data.summary.lastUpdate) {
                            const updateTime = new Date(result.data.summary.lastUpdate).toLocaleString('zh-CN');
                            
                            // åˆ›å»ºæˆ–æ›´æ–°çŠ¶æ€æ˜¾ç¤ºå…ƒç´ 
                            let statusDiv = document.getElementById('positionUpdateInfo');
                            if (!statusDiv) {
                                statusDiv = document.createElement('div');
                                statusDiv.id = 'positionUpdateInfo';
                                statusDiv.className = 'position-update-info';
                                const positionsContainer = document.getElementById('uploadedPositions');
                                if (positionsContainer) {
                                    positionsContainer.parentNode.insertBefore(statusDiv, positionsContainer);
                                }
                            }
                            
                            statusDiv.innerHTML = `
                                <div class="update-info">
                                    <span class="update-label">æ•°æ®æ›´æ–°æ—¶é—´:</span>
                                    <span class="update-time">${updateTime}</span>
                                </div>
                            `;
                        }
                        
                        console.log('âœ… ç”¨æˆ·æŒä»“æ•°æ®åŠ è½½æˆåŠŸ');
                    } else {
                        console.log('ç”¨æˆ·æš‚æ— æŒä»“æ•°æ®');
                    }
                } else {
                    console.error('è·å–æŒä»“æ•°æ®å¤±è´¥:', response.status);
                }
            } catch (error) {
                console.error('åŠ è½½ç”¨æˆ·æŒä»“æ•°æ®é”™è¯¯:', error);
            }
        }

        // æ˜¾ç¤ºå…‰å¤§è¯åˆ¸æŒä»“æ•°æ®
        function displayEBSCNPositions(data) {
            const { positions, summary } = data;
            
            // æ›´æ–°æ€»èµ„äº§å’Œæ€»ç›ˆäº
            document.getElementById('ebscnTotalValue').textContent = 
                `Â¥${summary.totalMarketValue.toLocaleString('zh-CN', {minimumFractionDigits: 2})}`;
            
            const profitClass = summary.totalProfitLoss >= 0 ? 'positive' : 'negative';
            document.getElementById('ebscnProfitLoss').innerHTML = 
                `æ€»ç›ˆäº: <span class="${profitClass}">Â¥${summary.totalProfitLoss.toLocaleString('zh-CN', {minimumFractionDigits: 2})} (${summary.totalProfitLossRate}%)</span>`;
            
            // æ˜¾ç¤ºæŒä»“åˆ—è¡¨
            const positionsContainer = document.getElementById('ebscnPositions');
            if (positions.length === 0) {
                positionsContainer.innerHTML = '<div class="loading-text">æš‚æ— æŒä»“æ•°æ®</div>';
                return;
            }

            positionsContainer.innerHTML = positions.map(position => {
                const profitLoss = parseFloat(position.profitLoss) || 0;
                const profitLossRate = parseFloat(position.profitLossRate) || 0;
                const isProfit = profitLoss >= 0;
                const profitIcon = isProfit ? 'ğŸ“ˆ' : 'ğŸ“‰';
                
                return `
                    <div class="position-card">
                        <div class="position-header">
                            <div class="stock-info">
                                <div class="stock-symbol">${position.stockCode}</div>
                                <div class="stock-name">${position.stockName}</div>
                            </div>
                            <div class="profit-indicator ${isProfit ? 'profit' : 'loss'}">
                                ${profitIcon}
                            </div>
                        </div>
                        
                        <div class="position-stats">
                            <div class="stat-row">
                                <div class="stat-item">
                                    <span class="stat-label">æŒä»“æ•°é‡</span>
                                    <span class="stat-value">${position.quantity}è‚¡</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">æˆæœ¬ä»·</span>
                                    <span class="stat-value">Â¥${parseFloat(position.costPrice).toFixed(2)}</span>
                                </div>
                            </div>
                            
                            <div class="stat-row">
                                <div class="stat-item">
                                    <span class="stat-label">å½“å‰ä»·</span>
                                    <span class="stat-value">Â¥${parseFloat(position.currentPrice).toFixed(2)}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">å¸‚å€¼</span>
                                    <span class="stat-value">Â¥${parseFloat(position.marketValue).toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="position-summary">
                            <div class="profit-loss ${isProfit ? 'profit' : 'loss'}">
                                <span class="profit-amount">${isProfit ? '+' : ''}Â¥${profitLoss.toFixed(2)}</span>
                                <span class="profit-rate">${isProfit ? '+' : ''}${profitLossRate.toFixed(2)}%</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ›´æ–°å¯¼èˆªæ çŠ¶æ€
        function updateNavbar(user) {
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            const adminBtn = document.getElementById('adminBtn');
            const userName = document.getElementById('userName');
            const userBadge = document.getElementById('userBadge');

            if (user) {
                // å·²ç™»å½•çŠ¶æ€
                userName.textContent = user.username;
                
                // è®¾ç½®ç”¨æˆ·ç­‰çº§æ ‡è¯†
                let badgeText = '';
                let badgeClass = '';
                
                switch(user.role) {
                    case 'super_admin':
                        badgeText = 'è¶…çº§ç®¡ç†å‘˜';
                        badgeClass = 'badge-super-admin';
                        break;
                    case 'admin':
                        badgeText = 'ç®¡ç†å‘˜';
                        badgeClass = 'badge-admin';
                        break;
                    default:
                        badgeText = 'ç”¨æˆ·';
                        badgeClass = 'badge-user';
                }
                
                userBadge.textContent = badgeText;
                userBadge.className = `user-badge ${badgeClass}`;
                
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'inline-block';
                
                // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œæ˜¾ç¤ºç®¡ç†æŒ‰é’®
                if (user.role === 'admin' || user.role === 'super_admin') {
                    adminBtn.style.display = 'inline-block';
                } else {
                    adminBtn.style.display = 'none';
                }
            } else {
                // æœªç™»å½•çŠ¶æ€
                userName.textContent = 'æ¸¸å®¢';
                userBadge.textContent = 'æ¸¸å®¢';
                userBadge.className = 'user-badge badge-user';
                loginBtn.style.display = 'inline-block';
                logoutBtn.style.display = 'none';
                adminBtn.style.display = 'none';
                
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.removeItem('token');
                localStorage.removeItem('user');
            }
        }

        // è·³è½¬åˆ°ç™»å½•é¡µé¢
        function goToLogin() {
            window.location.href = '/login.html';
        }

        // è·³è½¬åˆ°ç®¡ç†é¡µé¢
        function goToAdmin() {
            window.location.href = '/admin.html';
        }

        // é€€å‡ºç™»å½•
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            updateNavbar(null);
            
            // æ˜¾ç¤ºé€€å‡ºæˆåŠŸæ¶ˆæ¯
            showNotification('å·²æˆåŠŸé€€å‡ºç™»å½•', 'success');
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            // åˆ›å»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(notification);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // æ›´æ–°å½“å‰æ—¶é—´
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('zh-CN');
            const dateString = now.toLocaleDateString('zh-CN');
            
            document.getElementById('currentTime').textContent = timeString;
            
            // æ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡æœ€åæ›´æ–°æ—¶é—´
            if (now.getMinutes() % 5 === 0 && now.getSeconds() === 0) {
                document.getElementById('lastUpdate').textContent = `${dateString} ${timeString}`;
            }
        }

        // æ¨¡æ‹Ÿè‚¡ç¥¨æ•°æ®æ›´æ–°
        function updateStockData() {
            const stocks = ['AAPL', 'GOOGL', 'MSFT', 'TSLA', 'AMZN'];
            
            stocks.forEach(stock => {
                const priceElement = document.querySelector(`[data-stock="${stock}"] .stock-price`);
                const changeElement = document.querySelector(`[data-stock="${stock}"] .stock-change`);
                
                if (priceElement && changeElement) {
                    const currentPrice = parseFloat(priceElement.textContent.replace('$', '')) || 100;
                    const change = (Math.random() - 0.5) * 10;
                    const newPrice = Math.max(1, currentPrice + change);
                    const changePercent = ((change / currentPrice) * 100).toFixed(2);
                    
                    priceElement.textContent = `$${newPrice.toFixed(2)}`;
                    changeElement.textContent = `${changePercent}%`;
                    changeElement.className = `stock-change ${change >= 0 ? 'positive' : 'negative'}`;
                }
            });
        }

        // æ·»åŠ é€šçŸ¥æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            .notification {
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                z-index: 1000;
                animation: slideIn 0.3s ease;
            }
            
            .notification.success {
                background: linear-gradient(135deg, #27ae60, #2ecc71);
            }
            
            .notification.info {
                background: linear-gradient(135deg, #3498db, #2980b9);
            }
            
            .notification.error {
                background: linear-gradient(135deg, #e74c3c, #c0392b);
            }
            
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            .status-indicator {
                display: inline-block;
                width: 8px;
                height: 8px;
                border-radius: 50%;
                margin-left: 8px;
            }
            
            .status-indicator.online {
                background: #27ae60;
            }
            
            .status-indicator.offline {
                background: #95a5a6;
            }
            
            .user-info {
                display: flex;
                align-items: center;
                margin-right: 15px;
                font-weight: 600;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>