================================================================================
è¿œç¨‹æœåŠ¡å™¨ä¹°å…¥ç‚¹éªŒè¯åŠŸèƒ½ä¿®å¤æŒ‡å—
================================================================================

é—®é¢˜: è¿œç¨‹æœåŠ¡å™¨ç‚¹å‡» "éªŒè¯ä¹°å…¥ç‚¹" æŒ‰é’®æ—¶æŠ¥ 500 é”™è¯¯
åŸå› : è¿œç¨‹æœåŠ¡å™¨æ•°æ®åº“ç¼ºå°‘ buy_point_validations å’Œ validation_configs è¡¨

================================================================================
ä¿®å¤æ–¹å¼ 1: ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰
================================================================================

1. æ‰“å¼€å‘½ä»¤è¡Œï¼ˆWindows PowerShell æˆ– CMDï¼‰

2. è¿›å…¥é¡¹ç›®ç›®å½•:
   cd f:\Git\stock-manager

3. è¿è¡Œè‡ªåŠ¨åŒ–ä¿®å¤è„šæœ¬:
   scripts\deploy\fix-buy-point-tables.bat

4. æŒ‰ç…§æç¤ºæ“ä½œ:
   - è¾“å…¥ y ç¡®è®¤å¼€å§‹ä¿®å¤
   - è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰æ­¥éª¤

5. ç­‰å¾…å®Œæˆæç¤º "ğŸ‰ ä¿®å¤æˆåŠŸï¼"

================================================================================
ä¿®å¤æ–¹å¼ 2: æ‰‹åŠ¨æ‰§è¡Œï¼ˆå¦‚æœè‡ªåŠ¨åŒ–è„šæœ¬å¤±è´¥ï¼‰
================================================================================

1. SSH ç™»å½•è¿œç¨‹æœåŠ¡å™¨:
   ssh root@42.192.40.196

2. è¿›å…¥é¡¹ç›®ç›®å½•:
   cd /root/stock-manager

3. æ‹‰å–æœ€æ–°ä»£ç :
   git pull origin master

4. å¤‡ä»½æ•°æ®åº“ï¼ˆå¯é€‰ä½†æ¨èï¼‰:
   cp stock_manager.db stock_manager.db.backup-$(date +%Y%m%d-%H%M%S)

5. è¿è¡Œä¿®å¤è„šæœ¬:
   node scripts/fix-remote-database.js

6. ç¡®è®¤çœ‹åˆ° "âœ… è¿œç¨‹æ•°æ®åº“ä¿®å¤å®Œæˆï¼" æç¤º

7. é‡å¯æœåŠ¡:
   pm2 restart stock-manager

8. éªŒè¯æœåŠ¡çŠ¶æ€:
   pm2 list

================================================================================
éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸ
================================================================================

1. åœ¨æµè§ˆå™¨ä¸­è®¿é—®: http://42.192.40.196:3000

2. æ‚¬åœä»»æ„è‚¡ç¥¨ä»£ç ï¼ŒæŸ¥çœ‹è¯¦æƒ…æ‚¬æµ®æ¡†

3. ç‚¹å‡»å³ä¸Šè§’çš„ âœ… æŒ‰é’®ï¼ˆéªŒè¯ä¹°å…¥ç‚¹ï¼‰

4. åº”è¯¥èƒ½çœ‹åˆ°éªŒè¯çª—å£å¼¹å‡ºï¼Œä¸å†æŠ¥ 500 é”™è¯¯

================================================================================
æ–‡ä»¶è¯´æ˜
================================================================================

å·²åˆ›å»ºçš„æ–‡ä»¶:
âœ… scripts/fix-remote-database.js        - ä¿®å¤è„šæœ¬ï¼ˆå·²æ¨é€åˆ°GitHubï¼‰
âœ… scripts/DEPLOY_FIX.md                 - è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
âœ… scripts/deploy/fix-buy-point-tables.bat - è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

ä»£ç å·²æäº¤å¹¶æ¨é€åˆ° GitHub master åˆ†æ”¯:
Commit: 3a92563 - fix: æ·»åŠ è¿œç¨‹æœåŠ¡å™¨æ•°æ®åº“ä¿®å¤è„šæœ¬

================================================================================
æ•…éšœæ’æŸ¥
================================================================================

å¦‚æœä¿®å¤åä»ç„¶æŠ¥é”™:

1. æ£€æŸ¥è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ:
   ssh root@42.192.40.196
   cd /root/stock-manager
   sqlite3 stock_manager.db "SELECT name FROM sqlite_master WHERE type='table' AND name LIKE '%validation%';"

   åº”è¯¥çœ‹åˆ°:
   buy_point_validations
   validation_configs

2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—:
   pm2 logs stock-manager --lines 50

3. æ£€æŸ¥æœåŠ¡çŠ¶æ€:
   pm2 list

4. å¦‚æœéœ€è¦å®Œå…¨é‡å¯:
   pm2 restart stock-manager
   pm2 logs stock-manager

================================================================================
æŠ€æœ¯ç»†èŠ‚
================================================================================

åˆ›å»ºçš„è¡¨:
- buy_point_validations: å­˜å‚¨ä¹°å…¥ç‚¹éªŒè¯è®°å½•ï¼ˆè¯„åˆ†ã€æŒ‡æ ‡ã€å»ºè®®ç­‰ï¼‰
- validation_configs: å­˜å‚¨éªŒè¯é…ç½®ï¼ˆæƒé‡ã€é˜ˆå€¼ç­‰ï¼‰

åˆ›å»ºçš„ç´¢å¼•:
- idx_buy_validations_user_stock: ç”¨æˆ·+è‚¡ç¥¨ä»£ç ç´¢å¼•
- idx_buy_validations_time: éªŒè¯æ—¶é—´ç´¢å¼•
- idx_buy_validations_score: è¯„åˆ†ç´¢å¼•

é»˜è®¤é…ç½®:
- å·²è‡ªåŠ¨æ’å…¥é»˜è®¤è¯„åˆ†æƒé‡å’Œé˜ˆå€¼é…ç½®

================================================================================

æœ€åæ›´æ–°: 2025-11-27
