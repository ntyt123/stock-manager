#!/bin/bash
# ==========================================
# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è„šæœ¬ï¼ˆé€‚ç”¨äº1Panelç­‰å®¹å™¨ç¯å¢ƒï¼‰
# ==========================================

set -e

echo "ğŸš€ å¯åŠ¨ Stock Manager..."

# è¿›å…¥é¡¹ç›®ç›®å½•
cd "$(dirname "$0")/.."

# é‡æ–°ç¼–è¯‘åŸç”Ÿæ¨¡å—ï¼ˆè§£å†³Node.jsç‰ˆæœ¬ä¸åŒ¹é…é—®é¢˜ï¼‰
echo "ğŸ”§ é‡æ–°ç¼–è¯‘åŸç”Ÿæ¨¡å—..."
npm rebuild better-sqlite3 || echo "âš ï¸ better-sqlite3é‡ç¼–è¯‘å¤±è´¥ï¼Œå°è¯•ç»§ç»­..."

# åˆå§‹åŒ–æ•°æ®åº“
echo "ğŸ’¾ åˆå§‹åŒ–æ•°æ®åº“..."
node database/init.js

# å¯åŠ¨åº”ç”¨ï¼ˆå‰å°è¿è¡Œï¼‰
echo "ğŸŒ å¯åŠ¨åº”ç”¨æœåŠ¡å™¨..."
exec node server.js
